#!/usr/bin/env bash
set -euxo pipefail

command -v wslsys && {
    wslsys | grep WSL2 || {
        echo "This script is made for Ubuntu on WSL2. However, you seem to be using WSL1.";
        echo "Press enter to continue anyway.";
        read -r;
    };
}

export DOTFILES_ROOT="$HOME/.dotfiles"
git clone https://github.com/ho-oto/dotfiles-for-wsl2 "$DOTFILES_ROOT"
cd "$DOTFILES_ROOT"

export XDG_CONFIG_HOME="$HOME/.config"
export XDG_CACHE_HOME="$HOME/.cache"
export XDG_DATA_HOME="$HOME/.local/share"

script/apt
script/brew
[ -z "${CI:-}" ] && script/cuda
script/cargo
script/pyenv
script/dot
script/fisher
script/misc

[ -z "${CI:-}" ] && cp windows/* $(wslpath $(wslvar USERPROFILE))

echo "Set start_wsl_sshd.bat to Task Scheduler of windows"
